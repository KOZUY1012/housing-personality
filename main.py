import streamlit as st

st.set_page_config(page_title="자취 유형 테스트", page_icon="🏠")
st.title("🏠 나에게 맞는 자취 유형 테스트")

st.write("당신의 생활 스타일에 따라 알맞은 주거 유형을 추천해드립니다. 아래 질문에 답해보세요!")

# ========== 세션 상태 초기화 함수 ==========
def reset_survey():
    st.session_state.clear()
    # clear() 후 다음 렌더링 시 page와 scores가 없으므로, 아래 초기화 블록에서 다시 세팅됩니다.

# ========== 초기화 ==========
if "page" not in st.session_state:
    st.session_state.page = 0
if "scores" not in st.session_state:
    st.session_state.scores = {
        "독립형": 0,
        "공유형": 0,
        "라이프형": 0,
        "균형형": 0
    }

# ========== 질문 리스트 및 점수 매핑 ==========
questions = [
    ("Q1. 주말에 집에서 보내는 당신의 모습은?", [
        ("A. 집에서 혼자 영화/독서하는 시간이 가장 좋다", "독립형"),
        ("B. 친구들을 집에 초대해 어울리는 게 좋다", "공유형"),
        ("C. 나가서 시간을 보내고, 집은 잠만 자는 곳", "균형형"),
        ("D. 인테리어 꾸미며 나만의 힐링 공간을 만든다", "라이프형")
    ]),
    ("Q2. 다음 중 가장 싫은 것은?", [
        ("A. 룸메이트가 집에 친구를 데려오는 것", "독립형"),
        ("B. 혼자서 매일 밥 먹고 대화 없는 생활", "공유형"),
        ("C. 곰팡이나 방음 안 되는 집", "균형형"),
        ("D. 월세가 너무 비싼 집", "라이프형")
    ]),
    ("Q3. 집에서 가장 중요한 요소는?", [
        ("A. 방음/프라이버시", "독립형"),
        ("B. 교류와 공용 공간", "공유형"),
        ("C. 가성비와 교통 접근성", "균형형"),
        ("D. 인테리어와 분위기", "라이프형")
    ]),
    ("Q4. 월세와 생활비에 대한 당신의 생각은?", [
        ("A. 무조건 싼 게 최고", "독립형"),
        ("B. 적당히 나누면 부담 없다", "공유형"),
        ("C. 비싸도 내가 만족하면 OK", "균형형"),
        ("D. 너무 비싸면 스트레스 받음", "라이프형")
    ]),
    ("Q5. 화장실/부엌 등을 다른 사람과 공유하는 것에 대해", [
        ("A. 절대 싫다, 혼자 쓰고 싶다", "독립형"),
        ("B. 괜찮다, 룰만 잘 지키면 된다", "공유형"),
        ("C. 공동 사용보다 상태/관리 수준이 더 중요하다", "균형형"),
        ("D. 따로 써야 힐링이 된다", "라이프형")
    ]),
    ("Q6. 주말에 집에서 보내는 시간은 얼마나?", [
        ("A. 하루 종일 집에 있는 걸 선호한다", "독립형"),
        ("B. 친구들과 외출하거나 어울리는 시간이 많다", "공유형"),
        ("C. 외출과 휴식을 균형 있게 나누는 편이다", "균형형"),
        ("D. 집에서 감성적인 시간을 보내는 걸 좋아한다", "라이프형")
    ]),
    ("Q7. 집이 당신에게 주는 가장 큰 의미는?", [
        ("A. 혼자만의 안식처", "독립형"),
        ("B. 함께 어울리는 소통의 공간", "공유형"),
        ("C. 효율적인 생활의 기반", "균형형"),
        ("D. 나를 표현할 수 있는 감성 공간", "라이프형")
    ]),
    ("Q8. 좋은 집의 조건을 고른다면?", [
        ("A. 조용하고 나만의 공간 확보", "독립형"),
        ("B. 친구들과 어울릴 수 있는 구조", "공유형"),
        ("C. 교통/편의 시설 가까우면 충분하다", "균형형"),
        ("D. 감성적인 인테리어와 쾌적함", "라이프형")
    ]),
    ("Q9. 자취 초반, 예기치 못한 상황이 생긴다면?", [
        ("A. 혼자 해결할 수 있어야 한다고 생각한다", "독립형"),
        ("B. 누군가와 상의하고 함께 풀어가는 게 좋다", "공유형"),
        ("C. 실용적인 대안을 빠르게 찾을 것 같다", "균형형"),
        ("D. 나를 진정으로 위로해줄 공간이 필요하다", "라이프형")
    ]),
    ("Q10. 집에 가장 두고 싶은 물건은?", [
        ("A. 독서할 책", "독립형"),
        ("B. 게임기", "공유형"),
        ("C. 운동기구", "균형형"),
        ("D. 식물과 무드등", "라이프형")
    ]),
]

# ========== 질문 출력 ==========
if st.session_state.page < len(questions):
    question, options = questions[st.session_state.page]
    st.subheader(question)
    choice = st.radio("선택하세요:", [text for text, _ in options], key=f"q{st.session_state.page}")

    if st.button("다음 질문"):
        # 선택지에 따라 점수 증가
        for text, style in options:
            if choice == text:
                st.session_state.scores[style] += 1
                break
        st.session_state.page += 1

# ========== 결과 출력 ==========
else:
    st.subheader("🎉 결과 분석")
    result = max(st.session_state.scores, key=st.session_state.scores.get)

    # 1) 독립형
    if result == "독립형":
        st.markdown("""
        ### [독립형]
        **당신에게 가장 잘 맞는 자취 유형은 독립형입니다!**

        **혼자만의 공간이 가장 소중한 당신에게**

        **추천 주거 형태:** 고시원, 원룸(전/월세), 풀옵션 오피스텔 (소형)
        """)
        st.markdown("""
        **설명:**
        혼자 있는 시간이 많고, 타인과의 공동생활에 스트레스를 느끼는 타입입니다. 월세 부담이 적은 고시원부터, 방음과 프라이버시가 보장된 풀옵션 원룸까지, 혼자만의 공간을 확보하는 것이 무엇보다 중요합니다. 공간이 작더라도 나만의 리듬을 지킬 수 있는 주거 환경이 만족도를 크게 좌우합니다.

        📌 **고시원 계약 시 이것만은 꼭 확인하세요!**
        - 사업자등록 여부  
          정식 등록된 고시원인지 확인하고, 계약서에 사업자명과 대표자 정보가 명확히 기재되어야 합니다.
        - 계약 조건 서면 명시  
          월세, 보증금, 환불 규정 등을 반드시 서면으로 남기고, 구두 약속은 피하세요.
        - 화재·안전 설비 확인  
          스프링클러, 화재감지기, CCTV, 피난 계단 등의 유무를 꼭 확인하세요. 생명과 직결되는 요소입니다.
        - 생활 환경(방음/청결) 확인  
          방음, 환기 상태와 함께 공용 공간(화장실, 세탁실 등)의 청결도를 직접 확인하세요.
        - 숨은 추가 비용 확인  
          관리비, 공용 전기세, 와이파이, 세탁기 사용료 등 별도로 청구되는 비용이 있는지 체크하세요.
        - 이웃 분위기 파악  
          야간 소음, 흡연 여부 등 주변 입주자의 생활 습관도 내 생활 만족도에 큰 영향을 줍니다.
        - 지나치게 저렴한 방은 경계  
          공실이 많고 가격이 너무 낮다면, 운영 불안정 혹은 피해 이력이 있을 수 있습니다. 계약 전 후기 검색은 필수입니다!

        📌 **월세 원룸 계약 시 체크리스트**
        - 등기부등본 열람  
          해당 방의 실제 소유주(집주인)가 누구인지 확인하고, 근저당, 전세권, 가압류 등 권리관계도 반드시 체크하세요.
        - 계약서 서면 작성  
          월세, 보증금, 관리비, 계약 기간, 퇴실 조건 등을 명확히 기재하고, 중개인 이름·소속·면허번호도 포함되어야 합니다.
        - 확정일자 & 전입신고 필수  
          계약 후 바로 주민센터에서 확정일자 받기 + 전입신고를 해야 보증금 우선순위 보호를 받을 수 있어요.
        - 보증보험 가입 가능 여부 확인  
          전세가 아니어도 보증금이 크다면 HUG 등 보증보험 가입 가능 여부를 반드시 확인하세요.
        - 시설 상태 직접 점검  
          방음, 곰팡이, 누수, 창문 단열, 도어락 상태, 옵션 기기 작동 여부 등을 계약 전 직접 확인하고 사진으로 기록해두세요.
        - 관리비·공과금 구조 확인  
          전기세, 수도세, 인터넷, 청소비 등이 포함인지 별도인지 확인하세요. 계약서에 ‘관리비 포함’이라고 써 있어도 항목별 명시 없으면 분쟁 소지 있습니다.
        - 건물 환경과 이웃 분위기 체크  
          엘리베이터, 복도 CCTV, 출입문 통제 등 1인 가구 보안 환경을 반드시 확인하고, 소음 민감도도 미리 체크하세요.
        - 특이 조항/벌금 항목 유무 주의  
          ‘에어컨 사용 시 추가금’, ‘세탁기 물샘 시 세입자 부담’ 등 불합리한 조항이 있는지 반드시 읽어보세요.

        📌 **전세 원룸 계약 시 체크리스트**
        - 등기부등본 정밀 확인  
          해당 집의 소유자 이름, 근저당(담보대출), 가압류, 전세권 설정 여부를 모두 확인하세요.  
          ※ 집주인 명의가 아닌 경우, 반드시 위임장 등 추가 서류 필요!
        - 전입신고 + 확정일자 등록  
          계약 당일 주민센터 방문하여 전입신고 + 확정일자 등록을 해야 전세보증금 우선변제권을 받을 수 있습니다.
        - 보증보험 가입 가능 여부 확인  
          HUG(주택도시보증공사) 또는 SGI서울보증의 전세보증금 반환보증보험 가입 가능 여부를 반드시 확인하세요. 임대인이 거절하면 계약을 재검토해야 합니다.
        - 근저당 설정액과 보증금 비교  
          전세보증금 > 근저당 설정액이면 경매 시 보증금을 전액 잃을 수 있습니다. 전세권 설정 또는 보증보험으로 보완하세요.
        - 계약 시 공인중개사 자격 확인  
          중개사 자격증·등록증이 사무소에 정식 부착되어 있어야 하고, 중개보조인과의 계약은 피해야 합니다. 무자격 중개는 법적 보호를 받을 수 없습니다.
        - 임대인의 채무 이력 확인  
          최근 다가구·빌라 사기의 상당수가 ‘임대인 다중 채무자’에 의해 발생했습니다. 등기부등본상 과거 담보이력이 많거나 연속된 매매이력이 있으면 반드시 의심하세요.
        - ‘이중 계약’ 주의  
          같은 집에 여러 명이 전세 계약을 한 경우, 보증금 우선순위에서 밀려 돈을 못 받을 수 있습니다. 반드시 “입주 전 마지막 계약자”인지 확인하고, 다른 세입자가 있는지 중개인에게 확인 요청하세요.  
        - 임차권 등기명령 제도 숙지  
          보증금을 돌려받지 못할 경우 즉시 ‘임차권 등기명령’을 신청하여 권리를 보호하세요.
        - 특이 조항/벌금 항목 유무 주의  
          ‘에어컨 사용 시 추가금’, ‘세탁기 물샘 시 세입자 부담’ 등 불합리한 조항이 있는지 반드시 확인하세요.
        - 반지하/1층 주택 침수 위험 체크  
          하수구 역류 방지시설, 배수 펌프, 창틀 방수 여부 등을 반드시 살펴보세요. 포털 ‘침수지도’(https://floodmap.go.kr/fldara/fldaraList.do)에서 조회하는 것도 추천합니다.
        - 외부 관리 여부 확인  
          소규모 빌라·다가구는 경비·청소·분리수거·소방 관리가 부실한 경우가 많습니다. 공용 계단, 외벽, 우편함 상태를 눈으로 직접 확인하세요.
        - 중개인의 ‘신축’ or ‘최근 리모델링’ 발언 주의  
          도배+장판만 교체하고 “신축급”이라고 광고하는 사례가 많습니다. 수도관·전기 배선·보일러 연식 등 실질적인 설비 상태를 반드시 확인하세요.

        추가적 정보가 궁금하다면?
        [보조개하우스 인스타 바로가기](https://www.instagram.com/bojogae_house?igsh=ZGk3eTZib2t6NmZj&utm_source=qr)
        """)

    # 2) 공유형
    elif result == "공유형":
        st.markdown("""
        ### [공유형]
        **당신에게 가장 잘 맞는 자취 유형은 공유형입니다!**

        **외로움은 싫고, 함께 사는 재미가 좋은 당신에게**

        **추천 주거 형태:** 셰어하우스, 기숙사
        """)
        st.markdown("""
        **설명:**
        혼자 사는 건 외롭고 비효율적이라고 느끼는 사람입니다. 룸메이트와의 가벼운 대화, 공용 공간의 활기가 스트레스를 줄여주는 스타일이죠.

        📌 **셰어하우스 계약 시 이것만은 꼭 확인하세요!**
        - 계약 구조 확인 (개별 or 공동 계약)  
          개인별 계약인지, 공동 계약인지에 따라 보증금 책임·퇴실 조건이 달라집니다. 반드시 중개인 또는 운영자에게 확인하세요.
        - 하우스 룰 서면 확인  
          청소, 외부인 출입, 공용공간 사용, 취침 시간 등 생활 규칙이 문서로 정리되어 있는지 확인하고, 계약 전 반드시 읽어보세요.
        - 운영 주체 파악  
          운영사가 있는 셰어하우스인지, 집주인 개인 운영인지에 따라 문제 발생 시 대응 방식과 속도가 달라집니다.
        - 보증금·월세·공과금 구조 확인  
          공과금 포함 여부, 청소비·소모품비 등 추가 비용이 있는지 체크하고, 항목별로 분리 기재된 계약서를 요구하세요.
        - 공용 공간 상태 점검  
          화장실, 주방, 세탁기 등 공용 공간의 청결, 고장 유무, 청소 담당자가 정해져 있는지 직접 확인하세요.
        - 퇴실 조건 및 환불 규정 확인  
          중도 퇴실 시 위약금, 최소 거주 기간, 통보 시한 등의 조건을 반드시 확인하고, 계약서에 명확히 기재되어야 합니다.

        📌 **기숙사 계약 시 꼭 확인하세요!**
        - 계약 기간 & 퇴실 조건 체크  
          기숙사는 보통 학기 단위 계약입니다. 중도 퇴실 시 환불 불가, 위약금 조항이 있는지 확인하세요.
        - 생활 수칙 서면 확인  
          소등 시간, 외출 제한, 반입 금지 물품, 주방 사용 제한 등 생활 규칙이 매우 세부적일 수 있습니다. 모든 수칙을 계약서 또는 입주 안내문으로 사전에 확인하세요.
        - 보증금 및 벌점 제도 확인  
          기숙사마다 보증금, 입주비, 관리비 구조가 다르며, 생활 규칙 위반 시 벌점 → 퇴실 or 다음 학기 입주 제한이 있는 곳도 있으니 반드시 체크하세요.
        - 공용 공간 사용 방식 확인  
          샤워실, 세탁실, 주방 등은 이용 시간 제한, 청소 당번 규정, 예약제인 경우도 있습니다. 본인의 생활 스타일과 맞는지 확인하세요.

        추가적 정보가 궁금하다면?
        [보조개하우스 인스타 바로가기](https://www.instagram.com/bojogae_house?igsh=ZGk3eTZib2t6NmZj&utm_source=qr)
        """)

    # 3) 균형형
    elif result == "균형형":
        st.markdown("""
        ### [균형형]
        **당신에게 가장 잘 맞는 자취 유형은 균형형입니다!**

        **현실과 이상 사이에서 합리적인 선택을 하는 당신에게**

        **추천 주거 형태:** 다가구주택, 원룸빌라
        """)
        st.markdown("""
        **설명:**
        실용성과 효율을 중시하는 타입으로, 다양한 조건을 종합적으로 고려해 최선의 선택을 하려는 스타일입니다.

        📌 **월세 계약 시 꼭 확인하세요!**
        - 등기부등본 확인  
          해당 방의 실제 소유주가 누구인지 확인하고, 근저당, 전세권, 가압류 등 권리관계도 반드시 체크하세요.
        - 계약서 서면 작성  
          월세, 보증금, 관리비, 계약 기간, 퇴실 조건 등을 명확히 기재하고, 중개인 이름·소속·면허번호도 포함되어야 합니다.
        - 확정일자 & 전입신고 등록  
          계약 직후 주민센터에서 확정일자 + 전입신고를 하여 보증금 우선순위 보호를 받으세요.
        - 옵션 및 설비 상태 확인  
          방음, 곰팡이, 누수, 창문 단열, 도어락, 보일러 등 주요 설비 상태를 직접 점검하고 사진으로 기록하세요.
        - 침수 위험 체크 (반지하 등)  
          하수구 역류 방지시설, 배수 펌프, 창틀 방수 여부를 확인하세요. 포털 ‘침수지도’(https://floodmap.go.kr/fldara/fldaraList.do)에서 조회 가능합니다.

        📌 **전세 계약 시 꼭 확인하세요!**
        - 보증보험 가입 가능 여부 확인  
          HUG(주택도시보증공사) 또는 SGI서울보증의 전세보증금 반환보증보험 가입 가능 여부를 반드시 확인하세요.
        - 근저당 설정액과 보증금 비교  
          전세보증금 > 근저당 설정액이면 경매 시 보증금을 잃을 수 있습니다. 전세권 설정 또는 보증보험으로 보완하세요.
        - 이중 계약 및 무자격 중개인 경계  
          동일 물건에 여러 계약자가 있을 수 있습니다. 중개인 자격증·등록증을 확인하고, 무자격 중개인은 피하세요.
        - 임차권 등기명령 제도 숙지  
          보증금을 돌려받지 못할 경우 즉시 임차권 등기명령을 신청하여 권리를 보호하세요.

        추가적 정보가 궁금하다면?
        [보조개하우스 인스타 바로가기](https://www.instagram.com/bojogae_house?igsh=ZGk3eTZib2t6NmZj&utm_source=qr)
        """)

    # 4) 라이프형
    elif result == "라이프형":
        st.markdown("""
        ### [라이프형]
        **당신에게 가장 잘 맞는 자취 유형은 라이프형입니다!**

        **삶의 질을 가장 중시하는 당신에게**

        **추천 주거 형태:** 풀옵션 오피스텔, 신축 원룸, 주상복합
        """)
        st.markdown("""
        **설명:**
        가격보다 중요한 건 삶의 품질과 쾌적함입니다. 깔끔한 인테리어, 세련된 분위기, 최신 가전과 시스템에 대한 선호도가 높습니다. 공간 자체가 힐링이 되기를 원하고, 집에서 보내는 시간이 적더라도 그 품질은 포기하지 않습니다. 이런 타입은 다소 높은 월세라도 자기 관리와 라이프스타일에 어울리는 주거지를 찾는 경향이 있습니다.

        📌 **오피스텔/신축 계약 시 체크리스트**
        - 등기부등본 열람 (호실까지 정확히)  
          해당 호실의 실제 소유자가 누구인지, 근저당, 전세권, 가압류 여부를 반드시 확인하세요.
        - 옵션 항목과 관리비 구조 명시  
          TV, 에어컨, 세탁기, 냉장고, 전자레인지 등 풀옵션 항목을 계약서에 명시하고, 고장 시 수리 책임 소재도 함께 기재하세요.
        - 입주 청소 여부와 하자 점검  
          신축이라도 배수, 방음, 창호 단열, 누수, 곰팡이 여부를 직접 점검하고 사진 기록을 남기세요.
        - 보증보험 가입 가능 여부 확인  
          HUG 또는 SGI서울보증의 전세보증금 반환보증보험 가입 가능 여부를 반드시 확인하세요. 임대인이 거절하면 계약을 재검토하세요.
        - 위약금 및 중도 해지 조항 확인  
          계약서에 중도 해지 가능성, 위약금, 이사비 보전 여부 등을 미리 명시하고 협의하세요.

        📌 **전세 계약 시 주의할 점**
        - 근저당권 잔액 체크  
          전세보증금이 근저당 설정액을 초과하면 경매 시 보증금을 전액 잃을 수 있습니다. 전세권 설정이나 보증보험 가입으로 대비하세요.
        - 관리비 포함 항목 명시  
          냉난방, 공용전기, 청소비, 경비비 등 관리비 세부 항목을 확인하고 계약서에 명확히 기재하세요.
        - 옵션 기기 상태 점검 및 명세화  
          실내 옵션 기기의 수량·상태를 계약서에 기재해 고장 시 책임 소재를 명확히 하세요.
        - 하자 점검 및 사진 기록  
          배수, 방음, 창호, 누수, 곰팡이 등은 실제 생활에 큰 영향을 미칩니다. 입주 전 세심히 점검하고 사진으로 기록해 분쟁에 대비하세요.

        추가적 정보가 궁금하다면?
        [보조개하우스 인스타 바로가기](https://www.instagram.com/bojogae_house?igsh=ZGk3eTZib2t6NmZj&utm_source=qr)
        """)

    # ========== 재시작 버튼 ==========

    st.button("다시 시작하기", on_click=reset_survey)

    
